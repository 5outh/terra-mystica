<!DOCTYPE html>
<html>
  <head>
    <title>Terra Mystica - Create New Game</title>
    <script type="text/javascript" language="javascript"
            src="/stc/prototype-1.7.1.js">
    </script>
    <script type="text/javascript" language="javascript"
            src="/stc/debug.js">
    </script>
    <script type="text/javascript" language="javascript"
            src="/stc/common.js">
    </script>
    <link rel="stylesheet" type="text/css" href="/stc/style.css">
  </head>
  <body style="padding: 5ex">
    <div id="error"></div>
    <h3>Create new game</h3>
    <script>
      var state = null;
      function newGame() {
        $("error").innerHTML = "";
        $("csrf-token").value = getCSRFToken();
        disableDescendants($("submit"));
        $("newgame").request({
            method:"post",
            onSuccess: function(transport) {
                state = transport.responseText.evalJSON();
                enableDescendants($("submit"));
                if (state.link) {
                    document.location = state.link;
                } else if (state.error.length) {
                    $("error").innerHTML = state.error.join("<br>");
                }
            }
        });    
      }
    </script>
    <form id="newgame" action="/cgi-bin/newgame.pl" onsubmit="return false">
      <table>
        <tr><td>Game id<td><input name="gameid" id="gameid"></input>
        <tr><td><td><input id="submit" type="button" value="New Game" onclick="javascript:newGame()"></input>
      </table>
      <input type="hidden" id="csrf-token" name="csrf-token"></input>
    </form>
    <p>
      The id of the game should be unique, and only contain
      the letters A-Z and a-z and the digits 0-9.
    <p>
  </body>
</html>
